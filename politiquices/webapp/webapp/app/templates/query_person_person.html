
<br>

<div class="container">

    <div class="row justify-content-center">

        <div class="col-xs-6">

            <div id="outer_ent1" class="container d-flex align-items-center justify-content-center">
                <!-- Partidos -->
                <div class="col-auto">
                    <table>
                      <tbody>
                      {% for item in entity_one.parties %}
                      <tr>
                          <td>
                            <a href="/party_members?q={{item.wiki_id}}" target="_blank">
                                <img src={{item.image_url}} class="figure-img img-fluid rounded" width="60" height="75" alt="{{item.name}}" title="{{item.name}}">
                            </a>
                          </td>
                      </tr>
                      {% endfor %}
                      </tbody>
                    </table>
                </div>

                <!-- Foto -->
                <div class="media">
                    <figure class="figure">
                        <a href=/entity?q={{entity_one.wiki_id}} target="_blank">
                        <img src={{entity_one.image_url}} class="figure-img img-fluid rounded" width="144" height="180" alt="{{entity_one.name}}" title="{{entity_one.name}}">
                        </a>
                        <figcaption class="figure-caption" style="text-align:center;">
                            <b>{{entity_one.name}}</b>
                        </figcaption>
                    </figure>
                </div>

            </div>

        </div>

        <div class="col-xs-6">
            Relações de apoio/suporte entre XX e XX
        </div>

        <div class="col-xs-6">
            <div id="outer_ent2" class="container d-flex align-items-center justify-content-center">

                <!-- Foto -->
                <div class="media">
                    <figure class="figure">
                        <a href=/entity?q={{entity_two.wiki_id}} target="_blank">
                        <img src={{entity_two.image_url}} class="figure-img img-fluid rounded" width="144" height="180" alt="{{entity_two.name}}" title="{{entity_two.name}}">
                        </a>
                        <figcaption class="figure-caption" style="text-align:center;">
                            <b>{{entity_two.name}}</b>
                        </figcaption>
                    </figure>
                </div>

                <!-- Partidos -->
                <div class="col-auto">
                    <table>
                      <tbody>
                      {% for item in entity_two.parties %}
                      <tr>
                          <td>
                            <a href="/party_members?q={{item.wiki_id}}" target="_blank">
                                <img src={{item.image_url}} class="figure-img img-fluid rounded" width="60" height="75" alt="{{item.name}}" title="{{item.name}}">
                            </a>
                          </td>
                      </tr>
                      {% endfor %}
                      </tbody>
                    </table>
                    </div>

            </div>
        </div>

    </div>

    <!-- Char with relationships throughout the years -->
    <div class="container h-100">
      <div class="row h-100 justify-content-center align-items-center">
        <canvas id="myChart" width="900" height="250"></canvas>
      </div>
    </div>

    <script>

        var ctx = document.getElementById('myChart');
        var color = Chart.helpers.color;

        var year_labels = {{ labels|tojson }};
        var ent1_ent1_opposes_ent2 = {{ ent1_ent1_opposes_ent2|tojson }};
        var ent1_ent1_supports_ent2 = {{ ent1_ent1_supports_ent2|tojson }};
        var ent1_ent2_opposes_ent1 = {{ ent1_ent2_opposes_ent1|tojson }};
        var ent1_ent2_supports_ent1 = {{ ent1_ent2_supports_ent1|tojson }};

        var ent2_ent1_opposes_ent2 = {{ ent2_ent1_opposes_ent2|tojson }};
        var ent2_ent1_supports_ent2 = {{ ent2_ent1_supports_ent2|tojson }};
        var ent2_ent2_opposes_ent1 = {{ ent2_ent2_opposes_ent1|tojson }};
        var ent2_ent2_supports_ent1 = {{ ent2_ent2_supports_ent1|tojson }};

        var ent1_name = {{ entity_one.name|tojson }};
        var ent2_name = {{ entity_two.name|tojson }};

        var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: year_labels,
          datasets: [
            // entity one
            {label: 'ENT1-ent1_acusa_ent2', backgroundColor: "#FF0000", fill: true, data: ent1_ent1_opposes_ent2},
            {label: 'ENT1-ent1_apoia_ent2', backgroundColor: "#980000", fill: true, data: ent1_ent1_supports_ent2},
            {label: 'ENT1-ent2_acusa_ent1', backgroundColor: "#44861E", fill: true, data: ent1_ent2_opposes_ent1},
            {label: 'ENT1-ent2_apoia_ent1', backgroundColor: "#70DA33", fill: true, data: ent1_ent2_supports_ent1},
            // entity two
            {label: 'ENT2-ent1_acusa_ent2', backgroundColor: "#611808", fill: true, data: ent2_ent1_opposes_ent2},
            {label: 'ENT2-ent1_apoia_ent2', backgroundColor: "#086159", fill: true, data: ent2_ent1_supports_ent2},
            {label: 'ENT2-ent2_acusa_ent1', backgroundColor: "#083d61", fill: true, data: ent2_ent2_opposes_ent1},
            {label: 'ENT2-ent2_apoia_ent1', backgroundColor: "#1e0861", fill: true, data: ent2_ent2_supports_ent1}
            ]
          },
        options: {
          scales: {
            x: {stacked: true},
          }
        }
    });

    </script>

    <table id="titles" data-pagination="true" data-search="true" data-toggle="table" data-page-size="25">
      <thead>
        <tr>
            <th data-sortable="true" data-field="data">Data</th>
            <th data-field="title">Título</th>
            <th data-sortable="true" data-field="relationship">Relação</th>
            <th data-align="center" data-field="link">Artigo</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr class='clickable-row' data-href='{{item.url}}'>
            <td id="data">{{item.date}}</td>
            <td id="title">{{item.title_clickable|safe}}</td>
            <td id="relationship">{{item.rel_type}}</td>
            <td id="link">{{item.link|safe}}</td>
          </tr>
        {% endfor %}
      </tbody>
      </table>

</div>

<!-- Datatables -->
<script src="https://unpkg.com/bootstrap-table@1.18.1/dist/bootstrap-table.min.js"></script>
